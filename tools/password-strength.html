<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Password Analysis - Digital Tools</title>
    <link rel="icon" type="image/png" href="../assets/images/favicon.png">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Space+Grotesk:wght@400;700&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <script src="../assets/js/lucide.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/zxcvbn/4.4.2/zxcvbn.js"></script>
    <script src="../assets/js/app.js"></script>
    <link rel="stylesheet" href="../assets/css/global.css">
    <link rel="stylesheet" href="../assets/css/tools.css">
    <style>
        :root {
            --tool-accent: #10b981;
            /* Emerald Default */
        }

        .mono-font {
            font-family: 'JetBrains Mono', monospace;
        }

        .verdict-card {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }

        .mask-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.1);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            margin: 0.1rem;
            font-size: 0.9rem;
            font-family: 'JetBrains Mono', monospace;
        }

        .char-upper {
            color: #facc15;
        }

        .char-lower {
            color: #60a5fa;
        }

        .char-digit {
            color: #f472b6;
        }

        .char-symbol {
            color: #a78bfa;
        }

        .meter-container {
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin-top: 1rem;
            overflow: hidden;
        }

        .meter-fill {
            height: 100%;
            width: 0%;
            transition: width 0.5s ease, background 0.5s ease;
            box-shadow: 0 0 15px currentColor;
        }

        .crack-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .crack-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 8px;

            .char-pool-badge {
                display: inline-block;
                padding: 0.2rem 0.6rem;
                font-size: 0.75rem;
                border-radius: 4px;
                background: rgba(255, 255, 255, 0.05);
                color: #666;
                margin-right: 0.3rem;
                font-family: 'JetBrains Mono', monospace;
                transition: all 0.3s;
            }

            .char-pool-badge.active {
                background: var(--tool-accent);
                color: #000;
                font-weight: bold;
                box-shadow: 0 0 10px var(--tool-accent);
            }
        }
    </style>
    <style>
        @media (max-width: 768px) {
            .tools-container {
                padding: 1rem;
            }

            .input-group {
                flex-direction: column;
            }

            .tool-input,
            .tool-btn {
                width: 100%;
            }

            .tool-btn {
                margin-top: 0.5rem;
            }

            #verdictBox {
                padding: 1rem;
            }

            #gradeLabel {
                font-size: 3rem;
            }
        }
    </style>
    <!-- Theme Data Script -->
    <script>
        (function () {
            const savedTheme = localStorage.getItem("theme");
            const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const theme = savedTheme || (systemPrefersDark ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>
</head>

<body class="tools-page" data-theme="dark">
    <div style="padding: 1.5rem;">
        <a href="../tools.html" class="tool-btn"
            style="background:transparent; border:1px solid currentColor; color:inherit;">
            <i data-lucide="arrow-left" style="height:1em; vertical-align:middle;"></i> Back to Tools
        </a>
    </div>

    <div class="tools-container" style="max-width: 65rem;">
        <header class="tools-header" style="margin-top:1rem;">
            <h1 class="tools-title">Password Analysis Engine</h1>
            <p class="tools-subtitle">
                Advanced entropy calculation, structure masking, and realistic crack-time estimation (zxcvbn).
            </p>
        </header>

        <div class="tool-card" style="border-top: 3px solid var(--tool-accent);">
            <!-- Input -->
            <div class="input-group">
                <input type="text" id="passInput" class="tool-input" placeholder="Type a password to analyze..."
                    autocomplete="off" style="font-family:'JetBrains Mono', monospace; font-size:1.2rem;">
                <button id="toggleVisBtn" class="tool-btn" style="width: auto; padding: 0 1rem;">
                    <i data-lucide="eye"></i>
                </button>
            </div>

            <!-- Restored: Pool Indicators -->
            <div style="margin-top: 1rem; display:flex; justify-content:space-between; align-items:center;">
                <div>
                    <span id="pool-lower" class="char-pool-badge">abc</span>
                    <span id="pool-upper" class="char-pool-badge">ABC</span>
                    <span id="pool-num" class="char-pool-badge">123</span>
                    <span id="pool-sym" class="char-pool-badge">@#$</span>
                </div>
                <div class="char-pool-badge" style="background:transparent; color:#888;">
                    Length: <span id="len-val" style="color:white; font-weight:bold;">0</span>
                </div>
            </div>

            <!-- Analysis Area -->
            <div id="resultsArea" style="display:none; margin-top:2rem;">

                <!-- 1. Verdict Grade (Merged from Archive) -->
                <div class="verdict-card" id="verdictBox">
                    <div style="text-transform:uppercase; letter-spacing:1px; font-size:0.85rem; opacity:0.7;">Security
                        Verdict</div>
                    <div id="gradeLabel" style="font-size:5rem; font-weight:800; line-height:1;">F</div>
                    <div id="verdictText" style="font-size:1.2rem; margin-top:0.5rem;">Critical</div>

                    <div class="meter-container">
                        <div id="strengthMeter" class="meter-fill" style="width:0%;"></div>
                    </div>
                </div>

                <!-- 2. Structure Mask & Entropy (Merged Features) -->
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:2rem; margin-bottom:2rem;">
                    <div>
                        <h3 style="margin-top:0; border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:0.5rem;">
                            <i data-lucide="fingerprint" style="width:18px; vertical-align:middle;"></i> Structure Mask
                        </h3>
                        <div id="structureMask" class="mono-font"
                            style="font-size:1.1rem; word-break:break-all; line-height:1.8;"></div>
                        <p style="font-size:0.8rem; opacity:0.6; margin-top:0.5rem;">Visualizes the anatomy of your
                            password (Upper, Lower, Digit, Symbol).</p>
                    </div>
                    <div>
                        <h3 style="margin-top:0; border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:0.5rem;">
                            <i data-lucide="activity" style="width:18px; vertical-align:middle;"></i> Entropy Math
                        </h3>
                        <div style="font-size:2.5rem; font-weight:bold; font-family:'Space Grotesk';">
                            <span id="entropyVal">0</span> <span
                                style="font-size:1rem; opacity:0.6; font-weight:normal;">Bits</span>
                        </div>
                        <p style="font-size:0.8rem; opacity:0.6;">Theoretical search space size (logâ‚‚ of
                            combinations).
                        </p>
                    </div>
                </div>

                <!-- 3. Crack Time Grid (Hardware Scenarios) -->
                <h3 style="margin-top:2rem; border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:0.5rem;">
                    <i data-lucide="cpu" style="width:18px; vertical-align:middle;"></i> Crack Time by Hardware
                </h3>
                <div class="crack-grid">
                    <!-- Scenario 1: Gamer -->
                    <div class="crack-card">
                        <div style="color:#888; font-size:0.85rem;"><i data-lucide="gamepad-2"
                                style="width:14px; vertical-align:middle;"></i> Gamer PC</div>
                        <div id="time-gamer" class="mono-font" style="font-size:1.2rem; font-weight:bold; color:white;">
                            Instant</div>
                        <div style="font-size:0.75rem; opacity:0.5;">RTX 4090 (100 GH/s)</div>
                    </div>

                    <!-- Scenario 2: Hacker -->
                    <div class="crack-card" style="border-color:rgba(239, 68, 68, 0.3);">
                        <div style="color:#ef4444; font-size:0.85rem;"><i data-lucide="skull"
                                style="width:14px; vertical-align:middle;"></i> Hacker Farm</div>
                        <div id="time-hacker" class="mono-font"
                            style="font-size:1.2rem; font-weight:bold; color:white;">Instant</div>
                        <div style="font-size:0.75rem; opacity:0.5;">50x GPU Cluster</div>
                    </div>

                    <!-- Scenario 3: Government -->
                    <div class="crack-card" style="border-color:rgba(234, 179, 8, 0.3);">
                        <div style="color:#eab308; font-size:0.85rem;"><i data-lucide="server"
                                style="width:14px; vertical-align:middle;"></i> Supercomputer</div>
                        <div id="time-super" class="mono-font" style="font-size:1.2rem; font-weight:bold; color:white;">
                            Instant</div>
                        <div style="font-size:0.75rem; opacity:0.5;">Govt. Frontier Exascale</div>
                    </div>

                    <!-- Scenario 4: Quantum -->
                    <div class="crack-card" style="border-color:rgba(168, 85, 247, 0.3);">
                        <div style="color:#a855f7; font-size:0.85rem;"><i data-lucide="atom"
                                style="width:14px; vertical-align:middle;"></i> Quantum Threat</div>
                        <div id="time-quantum" class="mono-font"
                            style="font-size:1.2rem; font-weight:bold; color:white;">Instant</div>
                        <div style="font-size:0.75rem; opacity:0.5;">Grover's Algorithm</div>
                    </div>
                </div>

                <!-- 4. Feedback -->
                <div id="feedbackArea" style="margin-top:2rem;"></div>

            </div>
        </div>

        <!-- Educational Footer -->
        <div class="tool-card" style="margin-top: 2rem; background: rgba(0,0,0,0.2);">
            <h3><i data-lucide="book-open" style="vertical-align:middle; margin-right:0.5rem;"></i> The Math of Chaos
            </h3>
            <p style="opacity: 0.8; margin-top: 0.5rem; line-height: 1.6;">
                Password strength is measured in <strong>Entropy (Bits)</strong>. Formula:
                <code>E = L Ã— logâ‚‚(R)</code><br>
                However, this tool also runs <strong>zxcvbn</strong> to detect human patterns that lower real-world
                security despite high theoretical entropy.
            </p>
        </div>
    </div>



    <script>
        lucide.createIcons();
        const output = document.getElementById('resultsArea');
        const input = document.getElementById('passInput');

        // Badges
        const badgeLower = document.getElementById('pool-lower');
        const badgeUpper = document.getElementById('pool-upper');
        const badgeNum = document.getElementById('pool-num');
        const badgeSym = document.getElementById('pool-sym');
        const lenDisplay = document.getElementById('len-val');

        // Visibility Toggle
        let isVisible = true;
        document.getElementById('toggleVisBtn').addEventListener('click', () => {
            isVisible = !isVisible;
            input.type = isVisible ? 'text' : 'password';
            document.getElementById('toggleVisBtn').innerHTML = isVisible ? '<i data-lucide="eye"></i>' : '<i data-lucide="eye-off"></i>';
            lucide.createIcons();
        });

        input.addEventListener('input', () => {
            const val = input.value;
            lenDisplay.innerText = val.length; // Update Length

            // Update Badges
            badgeLower.classList.toggle('active', /[a-z]/.test(val));
            badgeUpper.classList.toggle('active', /[A-Z]/.test(val));
            badgeNum.classList.toggle('active', /[0-9]/.test(val));
            badgeSym.classList.toggle('active', /[^a-zA-Z0-9]/.test(val));

            if (!val) { output.style.display = 'none'; return; }
            output.style.display = 'block';

            // 1. ZXCVBN Analysis
            const result = zxcvbn(val);

            // 2. Entropy Calculation (Manual for display)
            const entropy = Math.floor(Math.log2(Math.pow(getPoolSize(val), val.length)));
            document.getElementById('entropyVal').innerText = isNaN(entropy) ? 0 : entropy;

            // 3. Verdict Rendering
            renderVerdict(result.score);

            // 4. Structure Mask
            renderMask(val);

            // 5. Hardare Time Calculations (Manual Math)
            // Average Guesses = 2^(Entropy - 1)
            const combinations = Math.pow(2, entropy - 1);

            // Hash Rates (H/s)
            const rateGamer = 1e11;   // 100 GH/s (RTX 4090 - MD5)
            const rateHacker = 5e12;  // 5 TH/s (Cluster)
            const rateSuper = 1e15;   // 1 PH/s (Govt)

            document.getElementById('time-gamer').innerText = formatTime(combinations / rateGamer);
            document.getElementById('time-hacker').innerText = formatTime(combinations / rateHacker);
            document.getElementById('time-super').innerText = formatTime(combinations / rateSuper);

            // Quantum Estimate (Entropy / 2 equivalent)
            const qSec = Math.pow(2, (entropy / 2)) / 1e9; // 1B ops/sec
            document.getElementById('time-quantum').innerText = formatTime(qSec);

            // 6. Feedback
            const feedContainer = document.getElementById('feedbackArea');
            feedContainer.innerHTML = '';
            if (result.feedback.warning) feedContainer.innerHTML += createAlert(result.feedback.warning, 'warn');
            if (result.feedback.suggestions) result.feedback.suggestions.forEach(s => feedContainer.innerHTML += createAlert(s, 'info'));

            lucide.createIcons();
        });

        function getPoolSize(pass) {
            let pool = 0;
            if (/[a-z]/.test(pass)) pool += 26;
            if (/[A-Z]/.test(pass)) pool += 26;
            if (/[0-9]/.test(pass)) pool += 10;
            if (/[^a-zA-Z0-9]/.test(pass)) pool += 33;
            return pool || 1;
        }

        function renderVerdict(score) {
            const elGrade = document.getElementById('gradeLabel');
            const elText = document.getElementById('verdictText');
            const elMeter = document.getElementById('strengthMeter');
            const box = document.getElementById('verdictBox');

            let grade = 'F'; let color = '#ef4444'; let text = 'Critical'; let width = '10%';

            if (score === 1) { grade = 'D'; color = '#f97316'; text = 'Weak'; width = '25%'; }
            if (score === 2) { grade = 'C'; color = '#facc15'; text = 'Medium'; width = '50%'; }
            if (score === 3) { grade = 'B'; color = '#3b82f6'; text = 'Strong'; width = '75%'; }
            if (score === 4) { grade = 'A'; color = '#10b981'; text = 'Excellent'; width = '100%'; }

            elGrade.innerText = grade; elGrade.style.color = color;
            elText.innerText = text; elText.style.color = color;
            elMeter.style.backgroundColor = color; elMeter.style.width = width;
            box.style.borderColor = color;
        }

        function renderMask(pass) {
            const container = document.getElementById('structureMask');
            container.innerHTML = '';
            for (let char of pass) {
                let type = 'other'; let symbol = '?';
                if (/[A-Z]/.test(char)) { type = 'upper'; symbol = 'U'; }
                else if (/[a-z]/.test(char)) { type = 'lower'; symbol = 'L'; }
                else if (/[0-9]/.test(char)) { type = 'digit'; symbol = 'D'; }
                else { type = 'symbol'; symbol = 'S'; }
                const span = document.createElement('span');
                span.className = `mask-badge char-${type}`;
                span.innerText = symbol;
                container.appendChild(span);
            }
        }

        function formatTime(seconds) {
            if (seconds < 1) return "Instant";
            if (seconds < 60) return Math.round(seconds) + "s";
            if (seconds < 3600) return Math.round(seconds / 60) + "m";
            if (seconds < 86400) return Math.round(seconds / 3600) + "h";
            if (seconds < 31536000) return Math.round(seconds / 86400) + "d";
            return "Years+";
        }

        function createAlert(msg, type) {
            const color = type === 'warn' ? '#ef4444' : '#3b82f6';
            const icon = type === 'warn' ? 'alert-triangle' : 'info';
            return `<div class="tool-card" style="padding:1rem; border-left:3px solid ${color}; margin-top:0.5rem;">
                <div style="font-weight:bold; color:${color}; margin-bottom:0.25rem;"><i data-lucide="${icon}" style="width:14px; vertical-align:middle;"></i> ${type === 'warn' ? 'Warning' : 'Tip'}</div>
                <div style="font-size:0.9rem; opacity:0.8;">${msg}</div>
            </div>`;
        }
    </script>
</body>

</html>